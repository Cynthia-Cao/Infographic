var global_data = {
    'Barton': {
        'incidents_num': 5507, 'shelter_num': 0, 'disbursements_num': 5471
    }, 'Gentry': {
        'incidents_num': 260, 'shelter_num': 0, 'disbursements_num': 300
    }, 'Barry': {
        'incidents_num': 6588, 'shelter_num': 0, 'disbursements_num': 6610
    }, 'Cape Girardeau': {
        'incidents_num': 16450, 'shelter_num': 1, 'disbursements_num': 14431
    }, 'McDonald': {
        'incidents_num': 3392, 'shelter_num': 0, 'disbursements_num': 3392
    }, 'Stoddard': {
        'incidents_num': 3257, 'shelter_num': 0, 'disbursements_num': 0
    }, 'Hickory': {
        'incidents_num': 1138, 'shelter_num': 0, 'disbursements_num': 1332
    }, 'Howard': {
        'incidents_num': 1670, 'shelter_num': 0, 'disbursements_num': 0
    }, 'Linn': {
        'incidents_num': 275, 'shelter_num': 0, 'disbursements_num': 275
    }, 'Caldwell': {
        'incidents_num': 600, 'shelter_num': 0, 'disbursements_num': 0
    }, 'Schuyler': {
        'incidents_num': 206, 'shelter_num': 0, 'disbursements_num': 198
    }, 'Polk': {
        'incidents_num': 9572, 'shelter_num': 1, 'disbursements_num': 10090
    }, 'St. Clair': {
        'incidents_num': 727, 'shelter_num': 1, 'disbursements_num': 779
    }, 'Andrew': {
        'incidents_num': 6160, 'shelter_num': 0, 'disbursements_num': 6160
    }, 'Lafayette': {
        'incidents_num': 21241, 'shelter_num': 1, 'disbursements_num': 20989
    }, 'Clark': {
        'incidents_num': 4267, 'shelter_num': 0, 'disbursements_num': 0
    }, 'Worth': {
        'incidents_num': 45, 'shelter_num': 0, 'disbursements_num': 0
    }, 'Randolph': {
        'incidents_num': 11897, 'shelter_num': 1, 'disbursements_num': 11897
    }, 'Vernon': {
        'incidents_num': 4677, 'shelter_num': 1, 'disbursements_num': 5463
    }, 'Johnson': {
        'incidents_num': 6414, 'shelter_num': 1, 'disbursements_num': 6420
    }, 'Clay': {
        'incidents_num': undefined, 'shelter_num': "2-4", 'disbursements_num': undefined
    }, 'Reynolds': {
        'incidents_num': 284, 'shelter_num': 1, 'disbursements_num': 0
    }, 'Texas': {
        'incidents_num': 6732, 'shelter_num': 1, 'disbursements_num': 0
    }, 'Dunklin': {
        'incidents_num': 1844, 'shelter_num': 1, 'disbursements_num': 0
    }, 'Lawrence': {
        'incidents_num': 6617, 'shelter_num': 0, 'disbursements_num': 6742
    }, 'Jackson': {
        'incidents_num': 172469, 'shelter_num': "5+", 'disbursements_num': 182000
    }, 'Chariton': {
        'incidents_num': 229, 'shelter_num': 0, 'disbursements_num': 250
    }, 'Cooper': {
        'incidents_num': 4970, 'shelter_num': 1, 'disbursements_num': 5061
    }, 'Benton': {
        'incidents_num': 5619, 'shelter_num': 1, 'disbursements_num': 5981
    }, 'Morgan': {
        'incidents_num': undefined, 'shelter_num': 0, 'disbursements_num': undefined
    }, 'Butler': {
        'incidents_num': 8306, 'shelter_num': "2-4", 'disbursements_num': 8315
    }, 'Gasconade': {
        'incidents_num': 565, 'shelter_num': 0, 'disbursements_num': 500
    }, 'Lincoln': {
        'incidents_num': 21006, 'shelter_num': 1, 'disbursements_num': 24639
    }, 'DeKalb': {
        'incidents_num': 472, 'shelter_num': 1, 'disbursements_num': 474
    }, 'St. Louis': {
        'incidents_num': 312416, 'shelter_num': "5+", 'disbursements_num': 303740
    }, 'Scott': {
        'incidents_num': 7928, 'shelter_num': "2-4", 'disbursements_num': 10322
    }, 'Miller': {
        'incidents_num': 6435, 'shelter_num': 0, 'disbursements_num': 0
    }, 'Shelby': {
        'incidents_num': 140, 'shelter_num': 0, 'disbursements_num': 464
    }, 'Pike': {
        'incidents_num': 4304, 'shelter_num': 0, 'disbursements_num': 4113
    }, 'Cass': {
        'incidents_num': 20778, 'shelter_num': "5+", 'disbursements_num': 22918
    }, 'Macon': {
        'incidents_num': 560, 'shelter_num': 0, 'disbursements_num': 0
    }, 'Daviess': {
        'incidents_num': 499, 'shelter_num': 0, 'disbursements_num': 0
    }, 'Grundy': {
        'incidents_num': 582, 'shelter_num': 0, 'disbursements_num': 491
    }, 'Douglas': {
        'incidents_num': 970, 'shelter_num': 0, 'disbursements_num': 850
    }, 'Howell': {
        'incidents_num': 14533, 'shelter_num': "2-4", 'disbursements_num': 14574
    }, 'Dent': {
        'incidents_num': 4119, 'shelter_num': 0, 'disbursements_num': 3742
    }, 'St. Francois': {
        'incidents_num': 14378, 'shelter_num': 1, 'disbursements_num': 14347
    }, 'Oregon': {
        'incidents_num': 310, 'shelter_num': 0, 'disbursements_num': 286
    }, 'Ripley': {
        'incidents_num': undefined, 'shelter_num': 1, 'disbursements_num': undefined
    }, 'Knox': {
        'incidents_num': 750, 'shelter_num': 0, 'disbursements_num': 0
    }, 'Maries': {
        'incidents_num': 1872, 'shelter_num': 0, 'disbursements_num': 2070
    }, 'Mississippi': {
        'incidents_num': undefined, 'shelter_num': 1, 'disbursements_num': undefined
    }, 'Crawford': {
        'incidents_num': undefined, 'shelter_num': 0, 'disbursements_num': undefined
    }, 'Laclede': {
        'incidents_num': 9615, 'shelter_num': 1, 'disbursements_num': 21300
    }, 'Saline': {
        'incidents_num': 5680, 'shelter_num': 1, 'disbursements_num': 12013
    }, 'Atchison': {
        'incidents_num': 3949, 'shelter_num': 1, 'disbursements_num': 3592
    }, 'Jefferson': {
        'incidents_num': undefined, 'shelter_num': 1, 'disbursements_num': undefined
    }, 'Washington': {
        'incidents_num': 3817, 'shelter_num': 0, 'disbursements_num': 5576
    }, 'Wright': {
        'incidents_num': 560, 'shelter_num': 0, 'disbursements_num': 500
    }, 'Iron': {
        'incidents_num': 255, 'shelter_num': 0, 'disbursements_num': 250
    }, 'Stone': {
        'incidents_num': 5856, 'shelter_num': "2-4", 'disbursements_num': 8003
    }, 'Cole': {
        'incidents_num': 13622, 'shelter_num': 1, 'disbursements_num': 13634
    }, 'Franklin': {
        'incidents_num': 3905, 'shelter_num': 0, 'disbursements_num': 0
    }, 'Phelps': {
        'incidents_num': 12729, 'shelter_num': 1, 'disbursements_num': 13570
    }, 'Marion': {
        'incidents_num': 14837, 'shelter_num': 1, 'disbursements_num': 14800
    }, 'Ralls': {
        'incidents_num': 513, 'shelter_num': 1, 'disbursements_num': 648
    }, 'Webster': {
        'incidents_num': 9145, 'shelter_num': 1, 'disbursements_num': 5459
    }, 'Audrain': {
        'incidents_num': 3805, 'shelter_num': 1, 'disbursements_num': 3344
    }, 'Ste. Genevieve': {
        'incidents_num': 9286, 'shelter_num': 0, 'disbursements_num': 10259
    }, 'Dade': {
        'incidents_num': 40, 'shelter_num': 0, 'disbursements_num': 60
    }, 'Camden': {
        'incidents_num': undefined, 'shelter_num': 1, 'disbursements_num': undefined
    }, 'Greene': {
        'incidents_num': 46907, 'shelter_num': 1, 'disbursements_num': 50000
    }, 'Livingston': {
        'incidents_num': 1416, 'shelter_num': 0, 'disbursements_num': 2000
    }, 'Callaway': {
        'incidents_num': 10486, 'shelter_num': 1, 'disbursements_num': 10000
    }, 'Pulaski': {
        'incidents_num': 13990, 'shelter_num': 1, 'disbursements_num': 16293
    }, 'Nodaway': {
        'incidents_num': 3268, 'shelter_num': 1, 'disbursements_num': 2652
    }, 'Ray': {
        'incidents_num': 4409, 'shelter_num': 0, 'disbursements_num': 4455
    }, 'Buchanan': {
        'incidents_num': 15581, 'shelter_num': "2-4", 'disbursements_num': 15581
    }, 'Scotland': {
        'incidents_num': 170, 'shelter_num': 0, 'disbursements_num': 0
    }, 'Pettis': {
        'incidents_num': 9038, 'shelter_num': 1, 'disbursements_num': 8916
    }, 'Harrison': {
        'incidents_num': 540, 'shelter_num': 0, 'disbursements_num': 807
    }, 'Newton': {
        'incidents_num': 7782, 'shelter_num': 1, 'disbursements_num': 7574
    }, 'Sullivan': {
        'incidents_num': 185, 'shelter_num': 0, 'disbursements_num': 0
    }, 'Ozark': {
        'incidents_num': 270, 'shelter_num': 0, 'disbursements_num': 250
    }, 'Holt': {
        'incidents_num': 135, 'shelter_num': 0, 'disbursements_num': 135
    }, 'Carter': {
        'incidents_num': 181, 'shelter_num': 0, 'disbursements_num': 346
    }, 'Lewis': {
        'incidents_num': 9306, 'shelter_num': 0, 'disbursements_num': 9482
    }, 'Moniteau': {
        'incidents_num': 2644, 'shelter_num': 0, 'disbursements_num': 2384
    }, 'Shannon': {
        'incidents_num': 660, 'shelter_num': 0, 'disbursements_num': 0
    }, 'Taney': {
        'incidents_num': 7530, 'shelter_num': 1, 'disbursements_num': 26338
    }, "St. Charles": {
        'incidents_num': undefined, 'shelter_num': 1, 'disbursements_num': undefined
    }, 'Carroll': {
        'incidents_num': 285, 'shelter_num': 0, 'disbursements_num': 1000
    }, 'Adair': {
        'incidents_num': 3542, 'shelter_num': 1, 'disbursements_num': 0
    }, 'Clinton': {
        'incidents_num': 5816, 'shelter_num': 1, 'disbursements_num': 6672
    }, 'Bollinger': {
        'incidents_num': 1102, 'shelter_num': 0, 'disbursements_num': 1104
    }, 'Monroe': {
        'incidents_num': 567, 'shelter_num': 0, 'disbursements_num': 416
    }, 'Bates': {
        'incidents_num': 632, 'shelter_num': 0, 'disbursements_num': 677
    }, ' Mercer': {
        'incidents_num': 215, 'shelter_num': 0, 'disbursements_num': 215
    }, 'Cedar': {
        'incidents_num': 4059, 'shelter_num': 0, 'disbursements_num': 7355
    }, 'Montgomery': {
        'incidents_num': 3428, 'shelter_num': 0, 'disbursements_num': 5012
    }, 'Henry': {
        'incidents_num': 982, 'shelter_num': 0, 'disbursements_num': 1077
    }, 'Osage': {
        'incidents_num': 2004, 'shelter_num': 0, 'disbursements_num': 2500
    }, 'New Madrid': {
        'incidents_num': 1110, 'shelter_num': 1, 'disbursements_num': 1110
    }, 'Putnam': {
        'incidents_num': 150, 'shelter_num': 0, 'disbursements_num': 170
    }, 'Platte': {
        'incidents_num': 29467, 'shelter_num': "2-4", 'disbursements_num': 30676
    }, 'Warren': {
        'incidents_num': 8110, 'shelter_num': 1, 'disbursements_num': 16516
    }, 'Perry': {
        'incidents_num': 9413, 'shelter_num': 1, 'disbursements_num': 9656
    }, 'Christian': {
        'incidents_num': 2455, 'shelter_num': 1, 'disbursements_num': 2455
    }, 'Wayne': {
        'incidents_num': 518, 'shelter_num': 0, 'disbursements_num': 518
    }, 'Madison': {
        'incidents_num': 912, 'shelter_num': 0, 'disbursements_num': 996
    }, 'Dallas': {
        'incidents_num': 572, 'shelter_num': 0, 'disbursements_num': 572
    }, 'Pemiscot': {
        'incidents_num': 647, 'shelter_num': 0, 'disbursements_num': 0
    }, 'Jasper': {
        'incidents_num': 33368, 'shelter_num': 1, 'disbursements_num': 31449
    }, 'Boone': {
        'incidents_num': 26126, 'shelter_num': 1, 'disbursements_num': 27806
    }
};


var mapChart;

$(function () {
    set_main_container_size();
    show_map();
    add_listener_of_resize();
});

function set_main_container_size() {
    $("#main").width($(window).width() - 50).height($(window).height() - 50);
}

function is_show_label_by_window_size() {
    return $("#main").width() > 900 && $("#main").height() > 500;
}

function add_listener_of_resize() {
    $(window).on('resize', function () {
        set_main_container_size();
        show_map();
    })
}


function show_map() {

    if (mapChart != null && mapChart != "" && mapChart != undefined) {
        mapChart.dispose();
    }

    mapChart = echarts.init(document.getElementById('main'));

    $.get('./MOGEO.json', function (MOJson) {
        echarts.registerMap('missouri', MOJson);

        var option = {
            /*title: {
                text:
                    '18 Counties Withheld Funds from' + '\n' + 'Domestic Violence Shelters in 2017',
                //subtext: "By Chengzi Cao, Autumn Black, Pate McCuien, Regan Huston", 
                left: "left",
                top: 60,
                textStyle: {
                    fontSize: "30",
                    fontFamily: 'Ultra', serif,


                },
                 subtextStyle:{
                      fontSize:"15",
                      color:"#5e5d5d",
                      position:"absolute",
                      top:"80%",
  
                  }


            },*/
            tooltip: {
                trigger: 'item',
                showDelay: 0,
                transitionDuration: 0.2,
                formatter: function (params) {
                    return 'Collected funds : ' + global_data[params.name].incidents_num + '<br/>' +
                        'Distributed funds : ' + global_data[params.name].disbursements_num + '<br/>' +
                        'Number of shelters : ' + global_data[params.name].shelter_num;

                }
           
            }, visualMap: {
                left: 'right',
                top: 60,
                min: 0,
                max: 1000,
                splitNumber: 5,
              
                textGap:20,
                itemHeight:450,
                itemWidth:50,
                inRange: {
                    color: ['#d94e5d', 'white'],
                },
                text: ['Distributed funds / High', 'Distributed funds / Low'],
                textStyle: {
                    color: "#5e5d5d",
                    fontSize: 15,
                    fontFamily: 'Times New Roman',
                
        
                },
                calculable: true,
                /*controller: {
                   set_main_container_size:'200%',
                   is_show_label_by_window_size: '200%',
                   fontSize: '200%',
                }*/
            },

            series: [
                {
                    name: 'Domestic Violence Shelter Resource',
                    type: 'map',
                    left: 550,
                    roam: false,
                    map: 'missouri',
                    selectedMode: true,
                    itemStyle: {
                        normal: { label: { show: is_show_label_by_window_size(), fontSize: 8 } },
                        emphasis: {
                            label: { show: false },
                            borderColor: '#fff',
                            borderWidth: 1
                        }
                    },
                    data: [
                        {
                            'name': 'Barton', 'value': 5471
                        },
                        {
                            'name': 'Gentry', 'value': 300
                        },
                        {
                            'name': 'Barry', 'value': 6610
                        },
                        {
                            'name': 'Cape Girardeau', 'value': 14431
                        },
                        {
                            'name': 'McDonald', 'value': 3392
                        },
                        {
                            'name': 'Stoddard', 'value': 0
                        },
                        {
                            'name': 'Hickory', 'value': 1332
                        },
                        {
                            'name': 'Howard', 'value': 0
                        },
                        {
                            'name': 'Linn', 'value': 275
                        },
                        {
                            'name': 'Caldwell', 'value': 0
                        },
                        {
                            'name': 'Schuyler', 'value': 198
                        },
                        {
                            'name': 'Polk', 'value': 10090
                        },
                        {
                            'name': 'St. Clair', 'value': 779
                        },
                        {
                            'name': 'Andrew', 'value': 6160
                        },
                        {
                            'name': 'Lafayette', 'value': 20989
                        },
                        {
                            'name': 'Clark', 'value': 0
                        },
                        {
                            'name': 'Worth', 'value': 0
                        },
                        {
                            'name': 'Randolph', 'value': 11897
                        },
                        {
                            'name': 'Vernon', 'value': 5463
                        },
                        {
                            'name': 'Johnson', 'value': 6420
                        },
                        {
                            'name': 'Clay', 'value': undefined
                        },
                        {
                            'name': 'Reynolds', 'value': 0
                        },
                        {
                            'name': 'Texas', 'value': 0
                        },
                        {
                            'name': 'Dunklin', 'value': 0
                        },
                        {
                            'name': 'Lawrence', 'value': 6742
                        },
                        {
                            'name': 'Jackson', 'value': 182000
                        },
                        {
                            'name': 'Chariton', 'value': 250
                        },
                        {
                            'name': 'Cooper', 'value': 5061
                        },
                        {
                            'name': 'Benton', 'value': 5981
                        },
                        {
                            'name': 'Morgan', 'value': undefined
                        },
                        {
                            'name': 'Butler', 'value': 8315
                        },
                        {
                            'name': 'Gasconade', 'value': 500
                        },
                        {
                            'name': 'Lincoln', 'value': 24639
                        },
                        {
                            'name': 'DeKalb', 'value': 474
                        },
                        {
                            'name': 'St. Louis', 'value': 303740
                        },
                        {
                            'name': 'Scott', 'value': 10322
                        },
                        {
                            'name': 'Miller', 'value': 0
                        },
                        {
                            'name': 'Shelby', 'value': 464
                        },
                        {
                            'name': 'Pike', 'value': 4113
                        },
                        {
                            'name': 'Cass', 'value': 22918
                        },
                        {
                            'name': 'Macon', 'value': 0
                        },
                        {
                            'name': 'Daviess', 'value': 0
                        },
                        {
                            'name': 'Grundy', 'value': 491
                        },
                        {
                            'name': 'Douglas', 'value': 850
                        },
                        {
                            'name': 'Howell', 'value': 14574
                        },
                        {
                            'name': 'Dent', 'value': 3742
                        },
                        {
                            'name': 'St. Francois', 'value': 14347
                        },
                        {
                            'name': 'Oregon', 'value': 286
                        },
                        {
                            'name': 'Ripley', 'value': undefined
                        },
                        {
                            'name': 'Knox', 'value': 0
                        },
                        {
                            'name': 'Maries', 'value': 2070
                        },
                        {
                            'name': 'Mississippi', 'value': undefined
                        },
                        {
                            'name': 'Crawford', 'value': undefined
                        },
                        {
                            'name': 'Laclede', 'value': 21300
                        },
                        {
                            'name': 'Saline', 'value': 12013
                        },
                        {
                            'name': 'Atchison', 'value': 3592
                        },
                        {
                            'name': 'Jefferson', 'value': undefined
                        },
                        {
                            'name': 'Washington', 'value': 5576
                        },
                        {
                            'name': 'Wright', 'value': 500
                        },
                        {
                            'name': 'Iron', 'value': 250
                        },
                        {
                            'name': 'Stone', 'value': 8003
                        },
                        {
                            'name': 'Cole', 'value': 13634
                        },
                        {
                            'name': 'Franklin', 'value': 0
                        },
                        {
                            'name': 'Phelps', 'value': 13570
                        },
                        {
                            'name': 'Marion', 'value': 14800
                        },
                        {
                            'name': 'Ralls', 'value': 648
                        },
                        {
                            'name': 'Webster', 'value': 5459
                        },
                        {
                            'name': 'Audrain', 'value': 3344
                        },
                        {
                            'name': 'Ste. Genevieve', 'value': 10259
                        },
                        {
                            'name': 'Dade', 'value': 60
                        },
                        {
                            'name': 'Camden', 'value': undefined
                        },
                        {
                            'name': 'Greene', 'value': 50000
                        },
                        {
                            'name': 'Livingston', 'value': 2000
                        },
                        {
                            'name': 'Callaway', 'value': 10000
                        },
                        {
                            'name': 'Pulaski', 'value': 16293
                        },
                        {
                            'name': 'Nodaway', 'value': 2652
                        },
                        {
                            'name': 'Ray', 'value': 4455
                        },
                        {
                            'name': 'Buchanan', 'value': 15581
                        },
                        {
                            'name': 'Scotland', 'value': 0
                        },
                        {
                            'name': 'Pettis', 'value': 8916
                        },
                        {
                            'name': 'Harrison', 'value': 807
                        },
                        {
                            'name': 'Newton', 'value': 7574
                        },
                        {
                            'name': 'Sullivan', 'value': 0
                        },
                        {
                            'name': 'Ozark', 'value': 250
                        },
                        {
                            'name': 'Holt', 'value': 135
                        },
                        {
                            'name': 'Carter', 'value': 346
                        },
                        {
                            'name': 'Lewis', 'value': 9482
                        },
                        {
                            'name': 'Moniteau', 'value': 2384
                        },
                        {
                            'name': 'Shannon', 'value': 0
                        },
                        {
                            'name': 'Taney', 'value': 26338
                        },
                        {
                            'name': 'St. Charles', 'value': undefined
                        },
                        {
                            'name': 'Carroll', 'value': 1000
                        },
                        {
                            'name': 'Adair', 'value': 0
                        },
                        {
                            'name': 'Clinton', 'value': 6672
                        },
                        {
                            'name': 'Bollinger', 'value': 1104
                        },
                        {
                            'name': 'Monroe', 'value': 416
                        },
                        {
                            'name': 'St. Louis', 'value': 303740
                        },
                        {
                            'name': 'Bates', 'value': 677
                        },
                        {
                            'name': 'Mercer', 'value': 215
                        },
                        {
                            'name': 'Cedar', 'value': 7355
                        },
                        {
                            'name': 'Montgomery', 'value': 5012
                        },
                        {
                            'name': 'Henry', 'value': 1077
                        },
                        {
                            'name': 'Osage', 'value': 2500
                        },
                        {
                            'name': 'New Madrid', 'value': 1110
                        },
                        {
                            'name': 'Putnam', 'value': 170
                        },
                        {
                            'name': 'Platte', 'value': 30676
                        },
                        {
                            'name': 'Warren', 'value': 16516
                        },
                        {
                            'name': 'Perry', 'value': 9656
                        },
                        {
                            'name': 'Christian', 'value': 2455
                        },
                        {
                            'name': 'Wayne', 'value': 518
                        },
                        {
                            'name': 'Madison', 'value': 996
                        },
                        {
                            'name': 'Dallas', 'value': 572
                        },
                        {
                            'name': 'Pemiscot', 'value': 0
                        },
                        {
                            'name': 'Jasper', 'value': 31449
                        },
                        {
                            'name': 'Boone', 'value': 27806
                        }
                    ]
                }
            ],
            /*
            geo: {
                map: 'missouri',
                itemStyle: {					// 定义样式
                    normal: {					// 普通状态下的样式
                        areaColor: '#323c48',
                        borderColor: '#111'
                    },
                    emphasis: {					// 高亮状态下的样式
                        areaColor: '#2a333d'
                    }
                }
            },
            */
            //backgroundColor: '#404a59',
        }

        mapChart.setOption(option);

    });

}


