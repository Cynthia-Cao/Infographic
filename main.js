var global_data = {
    'Barton': {
        'incidents_num': 3542, 'shelter_num': 4, 'disbursements_num': 15462
    }, 'Gentry': {
        'incidents_num': 4078, 'shelter_num': 3, 'disbursements_num': 18196
    }, 'Barry': {
        'incidents_num': 533, 'shelter_num': 4, 'disbursements_num': 11005
    }, 'Cape Girardeau': {
        'incidents_num': 2167, 'shelter_num': 4, 'disbursements_num': 37289
    }, 'McDonald': {
        'incidents_num': 2586, 'shelter_num': 1, 'disbursements_num': 30522
    }, 'Stoddard': {
        'incidents_num': 2247, 'shelter_num': 2, 'disbursements_num': 37982
    }, 'Hickory': {
        'incidents_num': 3977, 'shelter_num': 3, 'disbursements_num': 17726
    }, 'Howard': {
        'incidents_num': 2027, 'shelter_num': 4, 'disbursements_num': 46665
    }, 'Linn': {
        'incidents_num': 4679, 'shelter_num': 4, 'disbursements_num': 33947
    }, 'Caldwell': {
        'incidents_num': 2777, 'shelter_num': 3, 'disbursements_num': 7947
    }, 'Schuyler': {
        'incidents_num': 2535, 'shelter_num': 5, 'disbursements_num': 15527
    }, 'Polk': {
        'incidents_num': 3570, 'shelter_num': 5, 'disbursements_num': 28881
    }, 'St. Clair': {
        'incidents_num': 3001, 'shelter_num': 0, 'disbursements_num': 30173
    }, 'Andrew': {
        'incidents_num': 4808, 'shelter_num': 3, 'disbursements_num': 27824
    }, 'Lafayette': {
        'incidents_num': 3590, 'shelter_num': 3, 'disbursements_num': 25742
    }, 'Clark': {
        'incidents_num': 255, 'shelter_num': 0, 'disbursements_num': 49939
    }, 'Worth': {
        'incidents_num': 1459, 'shelter_num': 5, 'disbursements_num': 39196
    }, 'Randolph': {
        'incidents_num': 3754, 'shelter_num': 3, 'disbursements_num': 22027
    }, 'Vernon': {
        'incidents_num': 955, 'shelter_num': 1, 'disbursements_num': 31493
    }, 'Johnson': {
        'incidents_num': 3989, 'shelter_num': 4, 'disbursements_num': 37037
    }, 'Clay': {
        'incidents_num': 4829, 'shelter_num': 3, 'disbursements_num': 26199
    }, 'Reynolds': {
        'incidents_num': 2837, 'shelter_num': 4, 'disbursements_num': 6190
    }, 'Texas': {
        'incidents_num': 3238, 'shelter_num': 3, 'disbursements_num': 19119
    }, 'Dunklin': {
        'incidents_num': 56, 'shelter_num': 3, 'disbursements_num': 49037
    }, 'Lawrence': {
        'incidents_num': 1602, 'shelter_num': 5, 'disbursements_num': 31300
    }, 'Jackson': {
        'incidents_num': 224, 'shelter_num': 5, 'disbursements_num': 17907
    }, 'Chariton': {
        'incidents_num': 4913, 'shelter_num': 4, 'disbursements_num': 15457
    }, 'Cooper': {
        'incidents_num': 45, 'shelter_num': 0, 'disbursements_num': 38257
    }, 'Benton': {
        'incidents_num': 2033, 'shelter_num': 5, 'disbursements_num': 30266
    }, 'Morgan': {
        'incidents_num': 4117, 'shelter_num': 3, 'disbursements_num': 40218
    }, 'Butler': {
        'incidents_num': 1436, 'shelter_num': 5, 'disbursements_num': 41662
    }, 'Gasconade': {
        'incidents_num': 857, 'shelter_num': 2, 'disbursements_num': 34256
    }, 'Lincoln': {
        'incidents_num': 980, 'shelter_num': 4, 'disbursements_num': 44779
    }, 'DeKalb': {
        'incidents_num': 4505, 'shelter_num': 3, 'disbursements_num': 36665
    }, 'St. Louis': {
        'incidents_num': 655, 'shelter_num': 5, 'disbursements_num': 49760
    }, 'Scott': {
        'incidents_num': 2156, 'shelter_num': 0, 'disbursements_num': 35699
    }, 'Miller': {
        'incidents_num': 1992, 'shelter_num': 4, 'disbursements_num': 23036
    }, 'Shelby': {
        'incidents_num': 2884, 'shelter_num': 3, 'disbursements_num': 45284
    }, 'Pike': {
        'incidents_num': 3802, 'shelter_num': 1, 'disbursements_num': 24745
    }, 'Cass': {
        'incidents_num': 1849, 'shelter_num': 3, 'disbursements_num': 26146
    }, 'Macon': {
        'incidents_num': 3928, 'shelter_num': 4, 'disbursements_num': 34729
    }, 'Daviess': {
        'incidents_num': 2738, 'shelter_num': 2, 'disbursements_num': 20739
    }, 'Grundy': {
        'incidents_num': 4469, 'shelter_num': 3, 'disbursements_num': 34705
    }, 'Douglas': {
        'incidents_num': 3489, 'shelter_num': 3, 'disbursements_num': 19805
    }, 'Howell': {
        'incidents_num': 3161, 'shelter_num': 1, 'disbursements_num': 49415
    }, 'Dent': {
        'incidents_num': 4407, 'shelter_num': 3, 'disbursements_num': 25395
    }, 'St. Francois': {
        'incidents_num': 3010, 'shelter_num': 1, 'disbursements_num': 21119
    }, 'Oregon': {
        'incidents_num': 3803, 'shelter_num': 3, 'disbursements_num': 31746
    }, 'Ripley': {
        'incidents_num': 1832, 'shelter_num': 4, 'disbursements_num': 23172
    }, 'Knox': {
        'incidents_num': 983, 'shelter_num': 1, 'disbursements_num': 45810
    }, 'Maries': {
        'incidents_num': 3656, 'shelter_num': 1, 'disbursements_num': 47083
    }, 'Mississippi': {
        'incidents_num': 2859, 'shelter_num': 4, 'disbursements_num': 9034
    }, 'Crawford': {
        'incidents_num': 1293, 'shelter_num': 5, 'disbursements_num': 25839
    }, 'Laclede': {
        'incidents_num': 3093, 'shelter_num': 2, 'disbursements_num': 18398
    }, 'Saline': {
        'incidents_num': 552, 'shelter_num': 3, 'disbursements_num': 5800
    }, 'Atchison': {
        'incidents_num': 4042, 'shelter_num': 2, 'disbursements_num': 13526
    }, 'Jefferson': {
        'incidents_num': 347, 'shelter_num': 5, 'disbursements_num': 9278
    }, 'Washington': {
        'incidents_num': 939, 'shelter_num': 5, 'disbursements_num': 20922
    }, 'Wright': {
        'incidents_num': 3923, 'shelter_num': 5, 'disbursements_num': 31780
    }, 'Iron': {
        'incidents_num': 3761, 'shelter_num': 5, 'disbursements_num': 30520
    }, 'Stone': {
        'incidents_num': 3210, 'shelter_num': 0, 'disbursements_num': 40986
    }, 'Cole': {
        'incidents_num': 3740, 'shelter_num': 2, 'disbursements_num': 8133
    }, 'Franklin': {
        'incidents_num': 2843, 'shelter_num': 0, 'disbursements_num': 39292
    }, 'Phelps': {
        'incidents_num': 1723, 'shelter_num': 5, 'disbursements_num': 43427
    }, 'Marion': {
        'incidents_num': 3893, 'shelter_num': 0, 'disbursements_num': 15104
    }, 'Ralls': {
        'incidents_num': 3702, 'shelter_num': 2, 'disbursements_num': 6089
    }, 'Webster': {
        'incidents_num': 721, 'shelter_num': 5, 'disbursements_num': 31086
    }, 'Audrain': {
        'incidents_num': 3123, 'shelter_num': 2, 'disbursements_num': 7922
    }, 'Ste. Genevieve': {
        'incidents_num': 1489, 'shelter_num': 1, 'disbursements_num': 5714
    }, 'Dade': {
        'incidents_num': 69, 'shelter_num': 3, 'disbursements_num': 8964
    }, 'Camden': {
        'incidents_num': 2447, 'shelter_num': 4, 'disbursements_num': 41435
    }, 'Greene': {
        'incidents_num': 4258, 'shelter_num': 0, 'disbursements_num': 30162
    }, 'Livingston': {
        'incidents_num': 226, 'shelter_num': 0, 'disbursements_num': 38019
    }, 'Callaway': {
        'incidents_num': 4552, 'shelter_num': 5, 'disbursements_num': 21574
    }, 'Pulaski': {
        'incidents_num': 4353, 'shelter_num': 2, 'disbursements_num': 9531
    }, 'Nodaway': {
        'incidents_num': 528, 'shelter_num': 3, 'disbursements_num': 44246
    }, 'Ray': {
        'incidents_num': 2855, 'shelter_num': 2, 'disbursements_num': 38398
    }, 'Buchanan': {
        'incidents_num': 3944, 'shelter_num': 1, 'disbursements_num': 48079
    }, 'Scotland': {
        'incidents_num': 2025, 'shelter_num': 5, 'disbursements_num': 35147
    }, 'Pettis': {
        'incidents_num': 3429, 'shelter_num': 2, 'disbursements_num': 25419
    }, 'Harrison': {
        'incidents_num': 328, 'shelter_num': 3, 'disbursements_num': 20999
    }, 'Newton': {
        'incidents_num': 4200, 'shelter_num': 4, 'disbursements_num': 18603
    }, 'Sullivan': {
        'incidents_num': 1701, 'shelter_num': 5, 'disbursements_num': 22085
    }, 'Ozark': {
        'incidents_num': 1095, 'shelter_num': 2, 'disbursements_num': 41101
    }, 'Holt': {
        'incidents_num': 511, 'shelter_num': 0, 'disbursements_num': 36273
    }, 'Carter': {
        'incidents_num': 3572, 'shelter_num': 1, 'disbursements_num': 15583
    }, 'Lewis': {
        'incidents_num': 3441, 'shelter_num': 0, 'disbursements_num': 10300
    }, 'Moniteau': {
        'incidents_num': 1933, 'shelter_num': 1, 'disbursements_num': 38918
    }, 'Shannon': {
        'incidents_num': 1746, 'shelter_num': 2, 'disbursements_num': 42219
    }, 'Taney': {
        'incidents_num': 680, 'shelter_num': 1, 'disbursements_num': 26338
    }, 'St. Charles': {
        'incidents_num': 3207, 'shelter_num': 1, 'disbursements_num': 7712
    }, 'Carroll': {
        'incidents_num': 971, 'shelter_num': 5, 'disbursements_num': 12351
    }, 'Adair': {
        'incidents_num': 2629, 'shelter_num': 3, 'disbursements_num': 26789
    }, 'Clinton': {
        'incidents_num': 4731, 'shelter_num': 1, 'disbursements_num': 46299
    }, 'Bollinger': {
        'incidents_num': 916, 'shelter_num': 1, 'disbursements_num': 38885
    }, 'Monroe': {
        'incidents_num': 545, 'shelter_num': 0, 'disbursements_num': 19849
    }, 'Bates': {
        'incidents_num': 2720, 'shelter_num': 1, 'disbursements_num': 37170
    }, 'Mercer': {
        'incidents_num': 3925, 'shelter_num': 2, 'disbursements_num': 37979
    }, 'Cedar': {
        'incidents_num': 1602, 'shelter_num': 3, 'disbursements_num': 33429
    }, 'Montgomery': {
        'incidents_num': 3971, 'shelter_num': 3, 'disbursements_num': 23854
    }, 'Henry': {
        'incidents_num': 1460, 'shelter_num': 5, 'disbursements_num': 26041
    }, 'Osage': {
        'incidents_num': 3975, 'shelter_num': 2, 'disbursements_num': 21193
    }, 'New Madrid': {
        'incidents_num': 1984, 'shelter_num': 2, 'disbursements_num': 25876
    }, 'Putnam': {
        'incidents_num': 4239, 'shelter_num': 1, 'disbursements_num': 42656
    }, 'Platte': {
        'incidents_num': 2523, 'shelter_num': 4, 'disbursements_num': 48505
    }, 'Warren': {
        'incidents_num': 971, 'shelter_num': 3, 'disbursements_num': 18381
    }, 'Perry': {
        'incidents_num': 402, 'shelter_num': 5, 'disbursements_num': 9290
    }, 'Christian': {
        'incidents_num': 2327, 'shelter_num': 0, 'disbursements_num': 35859
    }, 'Wayne': {
        'incidents_num': 2141, 'shelter_num': 5, 'disbursements_num': 33455
    }, 'Madison': {
        'incidents_num': 4411, 'shelter_num': 5, 'disbursements_num': 47643
    }, 'Dallas': {
        'incidents_num': 3422, 'shelter_num': 0, 'disbursements_num': 13061
    }, 'Pemiscot': {
        'incidents_num': 528, 'shelter_num': 4, 'disbursements_num': 42625
    }, 'Jasper': {
        'incidents_num': 3057, 'shelter_num': 3, 'disbursements_num': 22515
    }, 'Boone': {
        'incidents_num': 3403, 'shelter_num': 0, 'disbursements_num': 19315
    }
};

var mapChart;

$(function () {
    set_main_container_size();
    show_map();
    add_listener_of_resize();
});

function set_main_container_size() {
    $("#main").width($(window).width() - 50).height($(window).height() - 50);
}

function add_listener_of_resize() {
    $(window).on('resize', function () {
        set_main_container_size();
        show_map();
    })
}

function show_map() {

    if (mapChart != null && mapChart != "" && mapChart != undefined) {
        mapChart.dispose();
    }

    mapChart = echarts.init(document.getElementById('main'));

    $.get('./MOGEO.json', function (MOJson) {
        echarts.registerMap('missouri', MOJson);

        var option = {
            title: {
                text: 'Domestic Violence Shelter Funding, Locations and Incidents',
                subtext: 'Year Ended December 31, 2017',
                subtext: "MCADSV and Missouri State Highway Patrol data",
                sublink: "http://www.census.gov/popest/data/datasets.html",
                left: 'right'
            },
            tooltip: {
                trigger: 'item',
                showDelay: 0,
                transitionDuration: 0.2,
                formatter: function (params) {
                    return params.seriesName + '<br/>' + params.name + ':' + '<br/>' +
                        'Incidents num : ' + global_data[params.name].incidents_num + '<br/>' +
                        'Shelter num : ' + global_data[params.name].shelter_num + '<br/>' +
                        'Disbursements num : ' + global_data[params.name].disbursements_num;
                }
            },
            visualMap: {
                left: 'right',
                min: 0,
                max: 5000,
                inRange: {
                    color: ['#313695', '#4575b4', '#74add1', '#abd9e9', '#e0f3f8', '#ffffbf', '#fee090', '#fdae61', '#f46d43', '#d73027', '#a50026']
                },
                text: ['Incidents Num / High', 'Incidents Num / Low'],           // 文本，默认为数值文本
                calculable: true
            },
            toolbox: {
                show: true,
                //orient: 'vertical',
                left: 'left',
                top: 'top',
                feature: {
                    dataView: { readOnly: false },
                    restore: {},
                    saveAsImage: {}
                }
            },
            series: [
                {
                    name: 'Domestic Violence Shelter Resource',
                    type: 'map',
                    roam: true,
                    map: 'missouri',
                    itemStyle: {
                        emphasis: { label: { show: true } }
                    },
                    data: [
                        {
                            'name': 'Barton', 'value': 1253
                        },
                        {
                            'name': 'Gentry', 'value': 3579
                        },
                        {
                            'name': 'Barry', 'value': 1852
                        },
                        {
                            'name': 'Cape Girardeau', 'value': 1003
                        },
                        {
                            'name': 'McDonald', 'value': 4950
                        },
                        {
                            'name': 'Stoddard', 'value': 1943
                        },
                        {
                            'name': 'Hickory', 'value': 2368
                        },
                        {
                            'name': 'Howard', 'value': 2792
                        },
                        {
                            'name': 'Linn', 'value': 4690
                        },
                        {
                            'name': 'Caldwell', 'value': 1550
                        },
                        {
                            'name': 'Schuyler', 'value': 288
                        },
                        {
                            'name': 'Polk', 'value': 2183
                        },
                        {
                            'name': 'St. Clair', 'value': 4601
                        },
                        {
                            'name': 'Andrew', 'value': 4231
                        },
                        {
                            'name': 'Lafayette', 'value': 4550
                        },
                        {
                            'name': 'Clark', 'value': 582
                        },
                        {
                            'name': 'Worth', 'value': 4531
                        },
                        {
                            'name': 'Randolph', 'value': 3994
                        },
                        {
                            'name': 'Vernon', 'value': 2783
                        },
                        {
                            'name': 'Johnson', 'value': 2294
                        },
                        {
                            'name': 'Clay', 'value': 502
                        },
                        {
                            'name': 'Reynolds', 'value': 1790
                        },
                        {
                            'name': 'Texas', 'value': 3261
                        },
                        {
                            'name': 'Dunklin', 'value': 4884
                        },
                        {
                            'name': 'Lawrence', 'value': 2561
                        },
                        {
                            'name': 'Jackson', 'value': 2456
                        },
                        {
                            'name': 'Chariton', 'value': 1743
                        },
                        {
                            'name': 'Cooper', 'value': 3669
                        },
                        {
                            'name': 'Benton', 'value': 2922
                        },
                        {
                            'name': 'Morgan', 'value': 3795
                        },
                        {
                            'name': 'Butler', 'value': 739
                        },
                        {
                            'name': 'Gasconade', 'value': 1771
                        },
                        {
                            'name': 'Lincoln', 'value': 1838
                        },
                        {
                            'name': 'DeKalb', 'value': 4595
                        },
                        {
                            'name': 'St. Louis', 'value': 1407
                        },
                        {
                            'name': 'Scott', 'value': 4223
                        },
                        {
                            'name': 'Miller', 'value': 2084
                        },
                        {
                            'name': 'Shelby', 'value': 1800
                        },
                        {
                            'name': 'Pike', 'value': 1423
                        },
                        {
                            'name': 'Cass', 'value': 477
                        },
                        {
                            'name': 'Macon', 'value': 4216
                        },
                        {
                            'name': 'Daviess', 'value': 2919
                        },
                        {
                            'name': 'Grundy', 'value': 2462
                        },
                        {
                            'name': 'Douglas', 'value': 2091
                        },
                        {
                            'name': 'Howell', 'value': 928
                        },
                        {
                            'name': 'Dent', 'value': 2083
                        },
                        {
                            'name': 'St. Francois', 'value': 3791
                        },
                        {
                            'name': 'Oregon', 'value': 4473
                        },
                        {
                            'name': 'Ripley', 'value': 2741
                        },
                        {
                            'name': 'Knox', 'value': 2158
                        },
                        {
                            'name': 'Maries', 'value': 216
                        },
                        {
                            'name': 'Mississippi', 'value': 793
                        },
                        {
                            'name': 'Crawford', 'value': 3474
                        },
                        {
                            'name': 'Laclede', 'value': 46
                        },
                        {
                            'name': 'Saline', 'value': 3351
                        },
                        {
                            'name': 'Atchison', 'value': 0
                        },
                        {
                            'name': 'Jefferson', 'value': 4918
                        },
                        {
                            'name': 'Washington', 'value': 1590
                        },
                        {
                            'name': 'Wright', 'value': 1866
                        },
                        {
                            'name': 'Iron', 'value': 2534
                        },
                        {
                            'name': 'Stone', 'value': 4291
                        },
                        {
                            'name': 'Cole', 'value': 1971
                        },
                        {
                            'name': 'Franklin', 'value': 805
                        },
                        {
                            'name': 'Phelps', 'value': 1644
                        },
                        {
                            'name': 'Marion', 'value': 4967
                        },
                        {
                            'name': 'Ralls', 'value': 4658
                        },
                        {
                            'name': 'Webster', 'value': 1662
                        },
                        {
                            'name': 'Audrain', 'value': 756
                        },
                        {
                            'name': 'Ste. Genevieve', 'value': 498
                        },
                        {
                            'name': 'Dade', 'value': 1773
                        },
                        {
                            'name': 'Camden', 'value': 3714
                        },
                        {
                            'name': 'Greene', 'value': 257
                        },
                        {
                            'name': 'Livingston', 'value': 2408
                        },
                        {
                            'name': 'Callaway', 'value': 3934
                        },
                        {
                            'name': 'Pulaski', 'value': 719
                        },
                        {
                            'name': 'Nodaway', 'value': 3003
                        },
                        {
                            'name': 'Ray', 'value': 1600
                        },
                        {
                            'name': 'Buchanan', 'value': 2776
                        },
                        {
                            'name': 'Scotland', 'value': 286
                        },
                        {
                            'name': 'Pettis', 'value': 3329
                        },
                        {
                            'name': 'Harrison', 'value': 2305
                        },
                        {
                            'name': 'Newton', 'value': 1415
                        },
                        {
                            'name': 'Sullivan', 'value': 4071
                        },
                        {
                            'name': 'Ozark', 'value': 3335
                        },
                        {
                            'name': 'Holt', 'value': 4853
                        },
                        {
                            'name': 'Carter', 'value': 4040
                        },
                        {
                            'name': 'Lewis', 'value': 4309
                        },
                        {
                            'name': 'Moniteau', 'value': 2566
                        },
                        {
                            'name': 'Shannon', 'value': 3461
                        },
                        {
                            'name': 'Taney', 'value': 2792
                        },
                        {
                            'name': 'St. Charles', 'value': 1140
                        },
                        {
                            'name': 'Carroll', 'value': 4731
                        },
                        {
                            'name': 'Adair', 'value': 3543
                        },
                        {
                            'name': 'Clinton', 'value': 543
                        },
                        {
                            'name': 'Bollinger', 'value': 330
                        },
                        {
                            'name': 'Monroe', 'value': 4432
                        },
                        {
                            'name': 'St. Louis', 'value': 254
                        },
                        {
                            'name': 'Bates', 'value': 3661
                        },
                        {
                            'name': 'Mercer', 'value': 3713
                        },
                        {
                            'name': 'Cedar', 'value': 1970
                        },
                        {
                            'name': 'Montgomery', 'value': 1094
                        },
                        {
                            'name': 'Henry', 'value': 3179
                        },
                        {
                            'name': 'Osage', 'value': 4345
                        },
                        {
                            'name': 'New Madrid', 'value': 2328
                        },
                        {
                            'name': 'Putnam', 'value': 1448
                        },
                        {
                            'name': 'Platte', 'value': 3627
                        },
                        {
                            'name': 'Warren', 'value': 4797
                        },
                        {
                            'name': 'Perry', 'value': 572
                        },
                        {
                            'name': 'Christian', 'value': 192
                        },
                        {
                            'name': 'Wayne', 'value': 1100
                        },
                        {
                            'name': 'Madison', 'value': 820
                        },
                        {
                            'name': 'Dallas', 'value': 1610
                        },
                        {
                            'name': 'Pemiscot', 'value': 2699
                        },
                        {
                            'name': 'Jasper', 'value': 2652
                        },
                        {
                            'name': 'Boone', 'value': 1541
                        }
                    ]
                }
            ],
            /*
            geo: {
                map: 'missouri',
                itemStyle: {					// 定义样式
                    normal: {					// 普通状态下的样式
                        areaColor: '#323c48',
                        borderColor: '#111'
                    },
                    emphasis: {					// 高亮状态下的样式
                        areaColor: '#2a333d'
                    }
                }
            },
            */
            // backgroundColor: '#404a59',
        }

        mapChart.setOption(option);

    });

}


